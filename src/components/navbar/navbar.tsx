"use client";

import { useState } from "react";
import Image from "next/image";
import Link from "next/link";
import { usePathname } from "next/navigation";

import ShoppingCart from "../shopping-cart/shopping-cart";
import Button from "../button/button";
import { useResize } from "@/hooks/useResize.hook";
import { NavItem } from "@/models/navbar.model";
import burgerIcon from "@/assets/icons/burger-menu.svg";
import shoppingCartIcon from "@/assets/icons/shopping-cart.svg";
import styles from "./navbar.module.css";

interface Props {
  isAdmin: boolean;
  navItems: NavItem[];
}

const NavbarComponent = ({ isAdmin, navItems }: Props) => {
  const [slideMenuIsOpen, setSlideMenuIsOpen] = useState(false);
  const [shoppingCartIsOpen, setShoppingCartIsOpen] = useState(false);
  const { isMobile } = useResize();
  const pathname = usePathname();

  const openSlideMenu = () => setSlideMenuIsOpen(true);
  const closeSlideMenu = () => setSlideMenuIsOpen(false);

  const openSlideShoppingCart = () => setShoppingCartIsOpen(true);
  const closeSlideShoppingCart = () => setShoppingCartIsOpen(false);

  return (
    <nav className={styles.main_container}>
      <div
        className={`${styles.overlay} ${
          slideMenuIsOpen ? styles.menu_open : ""
        }`}
      >
        <div
          className={`${styles.nav_container} ${
            slideMenuIsOpen ? styles.nav_container_open : ""
          }`}
        >
          {navItems.map(({ name, route }) => (
            <Link
              key={name}
              href={route}
              className={`${styles.item} ${
                pathname === route ? styles.active : ""
              }`}
              onClick={closeSlideMenu}
            >
              {name}
            </Link>
          ))}
        </div>
        {isMobile && (
          <Button
            label="Cerrar"
            onClick={closeSlideMenu}
            customClass={styles.close_button}
          />
        )}
      </div>
      {!isAdmin && (
        <>
          <Image
            src={shoppingCartIcon}
            alt="shopping icon"
            className={styles.shopping_cart_icon}
            width={24}
            height={24}
            onClick={openSlideShoppingCart}
          />
          <ShoppingCart
            isOpen={shoppingCartIsOpen}
            closeSlide={closeSlideShoppingCart}
          />
        </>
      )}
      <Image
        src={burgerIcon}
        alt="burger icon"
        width={20}
        height={20}
        className={styles.burger_icon}
        onClick={openSlideMenu}
      />
    </nav>
  );
};

export default NavbarComponent;
